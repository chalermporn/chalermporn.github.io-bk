!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.scrollnav=e()}(this,function(){function c(t,e){var n,i={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n]);for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i}function l(t,e){if("object"!=typeof t)return Promise.reject(new Error("First argument must be an object"));if("object"!=typeof(e=e||document.body))return Promise.reject(new Error("Second argument must be an object"));e=e.getBoundingClientRect();return t.getBoundingClientRect().top-e.top}function d(t){return t.forEach(function(t){var e=document.querySelector("#"+t.id);t.offsetTop=l(e),t.subSections.length&&(t.subSections=d(t.subSections))}),t}function n(e){return function(t){return Math.pow(t,e)}}function i(e){return function(t){return 1-Math.abs(Math.pow(t-1,e))}}function t(e){return function(t){return t<.5?n(e)(2*t)/2:i(e)(2*t-1)/2+.5}}var f,h,p,g={linear:t(1),easeInQuad:n(2),easeOutQuad:i(2),easeInOutQuad:t(2),easeInCubic:n(3),easeOutCubic:i(3),easeInOutCubic:t(3),easeInQuart:n(4),easeOutQuart:i(4),easeInOutQuart:t(4),easeInQuint:n(5),easeOutQuint:i(5),easeInOutQuint:t(5)};function b(a,u){return new Promise(function(e,t){if("number"!=typeof a)return t(new Error("First argument must be a number"));if("string"!=typeof(u=u||"linear"))return t(new Error("Second argument must be a string"));var n,i=window.pageYOffset,s=a-i,r=(t=Math.abs(s/2),Math.min(Math.max(t,250),1200)),o=0;!function t(){n=g[u]((o+=20)/r),window.scroll(0,n*s+i),o<r?setTimeout(t,20):e(window.pageYOffset)}()})}function m(s){function t(){var t,e=window.scrollY||window.pageYOffset||document.body.scrollTop,n=e+.4*window.innerHeight,i=function t(e,n,i){var s,r;return e.forEach(function(t){t.offsetTop>i&&(s||!(t.offsetTop<n))||(s=t)}),s=s&&s.subSections.length&&(r=t(s.subSections,n,i))?r:s}(s.data,e,n);return t=i,e=s.nav,n=e.querySelector("[data-sn-active]"),t?(t=e.querySelector("[data-sn-section="+t.id+"]"))&&t!==n&&(n&&(n.classList.remove("scroll-nav__item--active"),n.removeAttribute("data-sn-active")),t.classList.add("scroll-nav__item--active"),t.setAttribute("data-sn-active",!0)):n&&(n.classList.remove("scroll-nav__item--active"),n.removeAttribute("data-sn-active")),i}return window.addEventListener("scroll",t),t}function v(t){return t instanceof Element}return Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),{init:function(t,e){if(this.settings=c({sections:"h2",insertTarget:t,insertLocation:"before",easingStyle:"easeOutQuad",updateHistory:!0},e),v(t))if(!this.settings.insertTarget||v(this.settings.insertTarget))if(["append","prepend","after","before"].includes(this.settings.insertLocation)){var n=t.querySelectorAll(this.settings.sections);if(n.length)return this.data=function i(t,s,r){void 0===r&&(r="scroll-nav");var o=[];return r+="__",t.forEach(function(t,e){var n=[],e=function(t,e){if("object"!=typeof t)return Promise.reject(new Error("First argument must be an object"));var n=t.id;if(!n){if("string"!=typeof e)return Promise.reject(new Error("Second argument must be a string"));t.id=n=e}return n}(t,r+(e+1));s.subSections&&t.matches(s.sections)&&(n=i(function(t,e,n){var i=[];for(t=t.nextElementSibling;t&&!t.matches(e);)n&&!t.matches(n)||i.push(t),t=t.nextElementSibling;return i}(t,s.sections,s.subSections),s,e)),o.push({id:e,text:t.innerText||t.textContent,offsetTop:l(t),subSections:n})}),o}(n,this.settings),this.nav=(a=this.data,(e=document.createElement("nav")).className="scroll-nav",e.innerHTML=function e(t,n){var i="scroll-nav"+((n=void 0===n?!1:n)?"__sub-":"__"),t="\n    "+t.map(function(t){return'<li class="'+i+'item" data-sn-section="'+t.id+'">\n            <a class="'+i+'link" href="#'+t.id+'">'+t.text+"</a>\n            "+(t.subSections&&t.subSections.length?""+e(t.subSections,!0):"")+"\n          </li>"}).join("")+"\n  ";return'\n    <ol class="'+i+'list">\n      '+t+"\n    </ol>\n  "}(a),e),a=(n=this).settings.insertTarget,"append"===(e=n.settings.insertLocation)?a.appendChild(n.nav):"prepend"===e?a.insertBefore(n.nav,a.firstChild):"before"===e?a.parentNode.insertBefore(n.nav,a):"after"===e&&a.parentNode.insertBefore(n.nav,a.nextSibling),o=(r=this).settings,r.nav.querySelectorAll("a").forEach(function(t){t.addEventListener("click",u)}),f=u,h=m(this),s=this,window.addEventListener("resize",i),p=i,this.settings.debug&&((a=document.createElement("div")).className="snDebugger",a.setAttribute("style","\n      position: fixed;\n      top: 40%;\n      height: 0px;\n      border-bottom:5px solid red;\n      border-top: 5px solid blue;\n      width: 100%;\n      opacity: .5;\n      pointer-events: none;\n    "),document.body.appendChild(a)),this.settings.onInit?this.settings.onInit():void 0;this.settings.debug&&console.error('\n        scrollnav build failed, could not find any "'+this.settings.sections+'"\n        elements inside of "'+t+'"\n      ')}else this.settings.debug&&console.error('\n        scrollnav build failed, options.insertLocation "'+this.settings.insertLocation+'" is not a valid option\n      ');else this.settings.debug&&console.error('\n        scrollnav build failed, options.insertTarget "'+t+'" is not an HTML Element\n      ');else this.settings.debug&&console.error('\n        scrollnav build failed, content argument "'+t+'" is not an HTML Element\n      ');function i(){s.data=d(s.data)}var s,r,o,a;function u(t){t.preventDefault();var e,n,i=.39*window.innerHeight;return b((e=t.target,n=r.data,e=e.getAttribute("href"),function e(t,n){var i;return t.forEach(function(t){t.id===n&&(i=t),t.subSections&&void 0===i&&(i=e(t.subSections,n))}),i}(n,e="#"===e.charAt(0)?e.substr(1):e).offsetTop-i),o.easingStyle).then(function(){o.updateHistory&&history.replaceState({},"",t.target.getAttribute("href")),o.onScroll&&o.onScroll()})}},destroy:function(t){if(this.settings=c(this.settings,t),t=this.nav,e=f,t.querySelectorAll("a").forEach(function(t){t.removeEventListener("click",e)}),t=h,window.removeEventListener("scroll",t),t=p,window.removeEventListener("resize",t),this.nav.remove(),this.settings.onDestroy)return this.settings.onDestroy();var e},updatePositions:function(t){if(this.settings=c(this.settings,t),this.data=d(this.data),this.settings.onUpdatePositions)return this.settings.onUpdatePositions()}}});